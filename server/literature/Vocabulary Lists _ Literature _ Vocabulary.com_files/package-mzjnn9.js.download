/*
 Cropper v4.0.0
 https://github.com/fengyuanchen/cropper

 Copyright (c) 2014-2018 Chen Fengyuan
 Released under the MIT license

 Date: 2018-04-01T06:27:27.267Z
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(h){var d=0;return function(){return d<h.length?{done:!1,value:h[d++]}:{done:!0}}};$jscomp.arrayIterator=function(h){return{next:$jscomp.arrayIteratorImpl(h)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,d,c){h!=Array.prototype&&h!=Object.prototype&&(h[d]=c.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(h,d){this.$jscomp$symbol$id_=h;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:d})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function h(c){if(this instanceof h)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+d++,c)}var d=0;return h}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.asyncIterator;h||(h=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};
$jscomp.makeIterator=function(h){var d="undefined"!=typeof Symbol&&Symbol.iterator&&h[Symbol.iterator];return d?d.call(h):$jscomp.arrayIterator(h)};
Module.define("cropper",["jquery","cropper.css"],function(h){(function(d,c){"object"===typeof exports&&"undefined"!==typeof h?c(require("jquery")):"function"===typeof define&&define.amd?define(["jquery"],c):c(d.jQuery)})(this,function(d){function c(b){return"number"===typeof b&&!ea(b)}function g(b){return"undefined"===typeof b}function a(b){return"object"===("undefined"===typeof b?"undefined":fa(b))&&null!==b}function k(b){if(!a(b))return!1;try{var f=b.constructor,e=f.prototype;return f&&e&&ha.call(e,
"isPrototypeOf")}catch(m){return!1}}function h(b){return"function"===typeof b}function l(b,f){if(b&&h(f))if(Array.isArray(b)||c(b.length)){var e=b.length,m=void 0;for(m=0;m<e&&!1!==f.call(b,b[m],m,b);m+=1);}else a(b)&&Object.keys(b).forEach(function(e){f.call(b,b[e],e,b)});return b}function A(b){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1E11;return ia.test(b)?Math.round(b*f)/f:b}function r(b,f){var e=b.style;l(f,function(b,f){ja.test(f)&&c(b)&&(b+="px");e[f]=b})}function z(b,f){return b.classList?
b.classList.contains(f):-1<b.className.indexOf(f)}function t(b,f){if(f)if(c(b.length))l(b,function(b){t(b,f)});else if(b.classList)b.classList.add(f);else{var e=b.className.trim();e?0>e.indexOf(f)&&(b.className=e+" "+f):b.className=f}}function E(b,f){f&&(c(b.length)?l(b,function(b){E(b,f)}):b.classList?b.classList.remove(f):0<=b.className.indexOf(f)&&(b.className=b.className.replace(f,"")))}function y(b,f,e){f&&(c(b.length)?l(b,function(b){y(b,f,e)}):e?t(b,f):E(b,f))}function B(b){return b.replace(ka,
"$1-$2").toLowerCase()}function J(b,f){return a(b[f])?b[f]:b.dataset?b.dataset[f]:b.getAttribute("data-"+B(f))}function L(b,f,e){a(e)?b[f]=e:b.dataset?b.dataset[f]=e:b.setAttribute("data-"+B(f),e)}function O(b,f){if(a(b[f]))try{delete b[f]}catch(e){b[f]=void 0}else if(b.dataset)try{delete b.dataset[f]}catch(e){b.dataset[f]=void 0}else b.removeAttribute("data-"+B(f))}function G(b,f,e){var m=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},a=e;f.trim().split(S).forEach(function(f){if(!T){var C=
b.listeners;C&&C[f]&&C[f][e]&&(a=C[f][e],delete C[f][e],0===Object.keys(C[f]).length&&delete C[f],0===Object.keys(C).length&&delete b.listeners)}b.removeEventListener(f,a,m)})}function F(b,f,e){var m=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},a=e;f.trim().split(S).forEach(function(f){if(m.once&&!T){var C=b.listeners,c=void 0===C?{}:C;a=function(){for(var C=arguments.length,I=Array(C),d=0;d<C;d++)I[d]=arguments[d];delete c[f][e];b.removeEventListener(f,a,m);e.apply(b,I)};c[f]||(c[f]=
{});c[f][e]&&b.removeEventListener(f,c[f][e],m);c[f][e]=a;b.listeners=c}b.addEventListener(f,a,m)})}function M(b,f,e){if(h(Event)&&h(CustomEvent))var m=new CustomEvent(f,{detail:e,bubbles:!0,cancelable:!0});else m=document.createEvent("CustomEvent"),m.initCustomEvent(f,!0,!0,e);return b.dispatchEvent(m)}function U(b){b=b.getBoundingClientRect();return{left:b.left+(window.pageXOffset-document.documentElement.clientLeft),top:b.top+(window.pageYOffset-document.documentElement.clientTop)}}function V(b){return(b=
b.match(la))&&(b[1]!==R.protocol||b[2]!==R.hostname||b[3]!==R.port)}function W(b){var f="timestamp\x3d"+(new Date).getTime();return b+(-1===b.indexOf("?")?"?":"\x26")+f}function N(b){var f=b.rotate,e=b.scaleX,m=b.scaleY,a=b.translateX;b=b.translateY;var I=[];c(a)&&0!==a&&I.push("translateX("+a+"px)");c(b)&&0!==b&&I.push("translateY("+b+"px)");c(f)&&0!==f&&I.push("rotate("+f+"deg)");c(e)&&1!==e&&I.push("scaleX("+e+")");c(m)&&1!==m&&I.push("scaleY("+m+")");f=I.length?I.join(" "):"none";return{WebkitTransform:f,
msTransform:f,transform:f}}function ma(b){var f=u({},b),e=[];l(b,function(b,a){delete f[a];l(f,function(f){var m=Math.abs(b.startX-f.startX),a=Math.abs(b.startY-f.startY),C=Math.abs(b.endX-f.endX);f=Math.abs(b.endY-f.endY);m=Math.sqrt(m*m+a*a);e.push((Math.sqrt(C*C+f*f)-m)/m)})});e.sort(function(b,f){return Math.abs(b)<Math.abs(f)});return e[0]}function P(b,f){var e=b.pageX;b=b.pageY;var m={endX:e,endY:b};return f?m:u({startX:e,startY:b},m)}function na(b){var f=0,e=0,m=0;l(b,function(b){var a=b.startY;
f+=b.startX;e+=a;m+=1});f/=m;e/=m;return{pageX:f,pageY:e}}function K(b){var f=b.aspectRatio,e=b.height,m=b.width,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"contain",c=function(b){return oa(b)&&0<b};c(m)&&c(e)?(c=e*f,"contain"===a&&c>m||"cover"===a&&c<m?e=m/f:m=e*f):c(m)?e=m/f:c(e)&&(m=e*f);return{width:m,height:e}}function pa(b,f,e,m){var a=f.aspectRatio,c=f.naturalWidth,d=f.naturalHeight,k=f.rotate;k=void 0===k?0:k;var g=f.scaleX;g=void 0===g?1:g;f=f.scaleY;f=void 0===f?1:f;var h=
e.aspectRatio,n=e.naturalWidth,l=e.naturalHeight;e=m.fillColor;e=void 0===e?"transparent":e;var p=m.imageSmoothingEnabled;p=void 0===p?!0:p;var r=m.imageSmoothingQuality;r=void 0===r?"low":r;var x=m.maxWidth,t=void 0===x?Infinity:x;x=m.maxHeight;var z=void 0===x?Infinity:x;x=m.minWidth;var u=void 0===x?0:x;m=m.minHeight;var B=void 0===m?0:m;m=document.createElement("canvas");x=m.getContext("2d");var w=K({aspectRatio:h,width:t,height:z});h=K({aspectRatio:h,width:u,height:B},"cover");n=Math.min(w.width,
Math.max(h.width,n));l=Math.min(w.height,Math.max(h.height,l));h=K({aspectRatio:a,width:t,height:z});a=K({aspectRatio:a,width:u,height:B},"cover");c=Math.min(h.width,Math.max(a.width,c));d=Math.min(h.height,Math.max(a.height,d));d=[-c/2,-d/2,c,d];m.width=A(n);m.height=A(l);x.fillStyle=e;x.fillRect(0,0,n,l);x.save();x.translate(n/2,l/2);x.rotate(k*Math.PI/180);x.scale(g,f);x.imageSmoothingEnabled=p;x.imageSmoothingQuality=r;x.drawImage.apply(x,[b].concat(X(d.map(function(b){return Math.floor(A(b))}))));
x.restore();return m}function qa(b){b=b.replace(ra,"");var f=atob(b);b=new ArrayBuffer(f.length);var e=new Uint8Array(b);l(e,function(b,a){e[a]=f.charCodeAt(a)});return b}function sa(b,f){b=new Uint8Array(b);var e="";l(b,function(b){e+=Y(b)});return"data:"+f+";base64,"+btoa(e)}d=jQuery;var Z="undefined"!==typeof window,H=Z?window:{},aa=H.PointerEvent?"pointerdown":"touchstart mousedown",ba=H.PointerEvent?"pointermove":"touchmove mousemove",ca=H.PointerEvent?"pointerup pointercancel":"touchend touchcancel mouseup",
ta=/^(?:e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,ua=/^data:/,va=/^data:image\/jpeg;base64,/,wa=/^(?:img|canvas)$/i,da={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,
minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var fa="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?
"symbol":typeof b},xa=function(){function b(b,e){for(var f=0;f<e.length;f++){var a=e[f];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(f,e,m){e&&b(f.prototype,e);m&&b(f,m);return f}}(),X=function(b){if(Array.isArray(b)){for(var f=0,e=Array(b.length);f<b.length;f++)e[f]=b[f];return e}return Array.from(b)},ea=Number.isNaN||H.isNaN,ha=Object.prototype.hasOwnProperty,u=Object.assign||function(b){for(var f=arguments.length,
e=Array(1<f?f-1:0),m=1;m<f;m++)e[m-1]=arguments[m];a(b)&&0<e.length&&e.forEach(function(f){a(f)&&Object.keys(f).forEach(function(e){b[e]=f[e]})});return b},ia=/\.\d*(?:0|9){12}\d*$/i,ja=/^(?:width|height|left|top|marginLeft|marginTop)$/,ka=/([a-z\d])([A-Z])/g,S=/\s\s*/,T=function(){var b=!1;if(Z){var f=!1,e=function(){},m=Object.defineProperty({},"once",{get:function(){b=!0;return f},set:function(b){f=b}});H.addEventListener("test",e,m);H.removeEventListener("test",e,m)}return b}(),R=H.location,la=
/^(https?:)\/\/([^:/?#]+):?(\d*)/i,oa=Number.isFinite||H.isFinite,Y=String.fromCharCode,ra=/^data:.*,/,ya=H.Cropper,Q=function(){function b(f){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");if(!f||!wa.test(f.tagName))throw Error("The first argument is required and must be an \x3cimg\x3e or \x3ccanvas\x3e element.");this.element=f;this.options=u({},da,k(e)&&e);this.disabled=this.cropped=!1;this.pointers=
{};this.sizing=this.sized=this.replaced=this.reloading=this.ready=!1;this.init()}xa(b,[{key:"init",value:function(){var b=this.element,e=b.tagName.toLowerCase(),m=void 0;if(!J(b,"cropper")){L(b,"cropper",this);if("img"===e){this.isImg=!0;this.originalUrl=m=b.getAttribute("src")||"";if(!m)return;m=b.src}else"canvas"===e&&window.HTMLCanvasElement&&(m=b.toDataURL());this.load(m)}}},{key:"load",value:function(b){var f=this;if(b){this.url=b;this.imageData={};var m=this.element,a=this.options;if(a.checkOrientation&&
window.ArrayBuffer)if(ua.test(b))va.test(b)?this.read(qa(b)):this.clone();else{var c=new XMLHttpRequest;this.reloading=!0;this.xhr=c;var d=function(){f.reloading=!1;f.xhr=null};c.ontimeout=d;c.onabort=d;c.onerror=function(){d();f.clone()};c.onload=function(){d();f.read(c.response)};a.checkCrossOrigin&&V(b)&&m.crossOrigin&&(b=W(b));c.open("get",b);c.responseType="arraybuffer";c.withCredentials="use-credentials"===m.crossOrigin;c.send()}else this.clone()}}},{key:"read",value:function(b){var f=this.options,
a=this.imageData;var c=new DataView(b);var d=void 0,k=void 0,g=void 0,h=void 0;if(255===c.getUint8(0)&&216===c.getUint8(1))for(var q=c.byteLength,l=2;l<q;){if(255===c.getUint8(l)&&225===c.getUint8(l+1)){g=l;break}l+=1}if(g){q=g+10;var p=g+4;l="";for(g=4+p;p<g;p+=1)l+=Y(c.getUint8(p));"Exif"===l&&(g=c.getUint16(q),!(k=18761===g)&&19789!==g||42!==c.getUint16(q+2,k)||(g=c.getUint32(q+4,k),8<=g&&(h=q+g)))}if(h)for(q=c.getUint16(h,k),l=0;l<q;l+=1)if(g=h+12*l+2,274===c.getUint16(g,k)){g+=8;d=c.getUint16(g,
k);c.setUint16(g,1,k);break}c=d;d=0;h=k=1;if(1<c){this.url=sa(b,"image/jpeg");d=0;b=k=1;switch(c){case 2:k=-1;break;case 3:d=-180;break;case 4:b=-1;break;case 5:d=90;b=-1;break;case 6:d=90;break;case 7:d=90;k=-1;break;case 8:d=-90}h=b}f.rotatable&&(a.rotate=d);f.scalable&&(a.scaleX=k,a.scaleY=h);this.clone()}},{key:"clone",value:function(){var b=this.element,e=this.url,a=void 0,c=void 0;this.options.checkCrossOrigin&&V(e)&&((a=b.crossOrigin)?c=e:(a="anonymous",c=W(e)));this.crossOrigin=a;this.crossOriginUrl=
c;var d=document.createElement("img");a&&(d.crossOrigin=a);d.src=c||e;e=this.start.bind(this);a=this.stop.bind(this);this.image=d;this.onStart=e;this.onStop=a;this.isImg?b.complete?this.timeout=setTimeout(e,0):F(b,"load",e,{once:!0}):(d.onload=e,d.onerror=a,t(d,"cropper-hide"),b.parentNode.insertBefore(d,b.nextSibling))}},{key:"start",value:function(b){var f=this,a=this.isImg?this.element:this.image;b&&(a.onload=null,a.onerror=null);this.sizing=!0;var c=H.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(H.navigator.userAgent),
d=function(b,e){u(f.imageData,{naturalWidth:b,naturalHeight:e,aspectRatio:b/e});f.sizing=!1;f.sized=!0;f.build()};if(a.naturalWidth&&!c)d(a.naturalWidth,a.naturalHeight);else{var k=document.createElement("img"),g=document.body||document.documentElement;this.sizingImage=k;k.onload=function(){d(k.width,k.height);c||g.removeChild(k)};k.src=a.src;c||(k.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",
g.appendChild(k))}}},{key:"stop",value:function(){var b=this.image;b.onload=null;b.onerror=null;b.parentNode.removeChild(b);this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var b=this.element,e=this.options,a=this.image,c=b.parentNode,d=document.createElement("div");d.innerHTML='\x3cdiv class\x3d"cropper-container" touch-action\x3d"none"\x3e\x3cdiv class\x3d"cropper-wrap-box"\x3e\x3cdiv class\x3d"cropper-canvas"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"cropper-drag-box"\x3e\x3c/div\x3e\x3cdiv class\x3d"cropper-crop-box"\x3e\x3cspan class\x3d"cropper-view-box"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-dashed dashed-h"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-dashed dashed-v"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-center"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-face"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-e" data-action\x3d"e"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-n" data-action\x3d"n"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-w" data-action\x3d"w"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-s" data-action\x3d"s"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-e" data-action\x3d"e"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-n" data-action\x3d"n"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-w" data-action\x3d"w"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-s" data-action\x3d"s"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-ne" data-action\x3d"ne"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-nw" data-action\x3d"nw"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-sw" data-action\x3d"sw"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-se" data-action\x3d"se"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e';
d=d.querySelector(".cropper-container");var k=d.querySelector(".cropper-canvas"),g=d.querySelector(".cropper-drag-box"),l=d.querySelector(".cropper-crop-box"),q=l.querySelector(".cropper-face");this.container=c;this.cropper=d;this.canvas=k;this.dragBox=g;this.cropBox=l;this.viewBox=d.querySelector(".cropper-view-box");this.face=q;k.appendChild(a);t(b,"cropper-hidden");c.insertBefore(d,b.nextSibling);this.isImg||E(a,"cropper-hide");this.initPreview();this.bind();e.aspectRatio=Math.max(0,e.aspectRatio)||
NaN;e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0;t(l,"cropper-hidden");e.guides||t(l.getElementsByClassName("cropper-dashed"),"cropper-hidden");e.center||t(l.getElementsByClassName("cropper-center"),"cropper-hidden");e.background&&t(d,"cropper-bg");e.highlight||t(q,"cropper-invisible");e.cropBoxMovable&&(t(q,"cropper-move"),L(q,"action","all"));e.cropBoxResizable||(t(l.getElementsByClassName("cropper-line"),"cropper-hidden"),t(l.getElementsByClassName("cropper-point"),"cropper-hidden"));
this.render();this.ready=!0;this.setDragMode(e.dragMode);e.autoCrop&&this.crop();this.setData(e.data);h(e.ready)&&F(b,"ready",e.ready,{once:!0});M(b,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),E(this.element,"cropper-hidden"))}},{key:"uncreate",value:function(){var b=this.element;this.ready?(this.unbuild(),this.cropped=this.ready=!1):this.sizing?(this.sizingImage.onload=null,this.sized=this.sizing=
!1):this.reloading?this.xhr.abort():this.isImg?b.complete?clearTimeout(this.timeout):G(b,"load",this.onStart):this.image&&this.stop()}}],[{key:"noConflict",value:function(){window.Cropper=ya;return b}},{key:"setDefaults",value:function(b){u(da,k(b)&&b)}}]);return b}();u(Q.prototype,{render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.cropped&&this.renderCropBox()},initContainer:function(){var b=this.element,f=this.options,e=this.container,a=this.cropper;
t(a,"cropper-hidden");E(b,"cropper-hidden");this.containerData=f={width:Math.max(e.offsetWidth,Number(f.minContainerWidth)||200),height:Math.max(e.offsetHeight,Number(f.minContainerHeight)||100)};r(a,{width:f.width,height:f.height});t(b,"cropper-hidden");E(a,"cropper-hidden")},initCanvas:function(){var b=this.containerData,f=this.imageData,e=this.options.viewMode,a=90===Math.abs(f.rotate)%180,c=a?f.naturalHeight:f.naturalWidth,d=a?f.naturalWidth:f.naturalHeight,k=c/d;a=b.width;var g=b.height;b.height*
k>b.width?3===e?a=b.height*k:g=b.width/k:3===e?g=b.width/k:a=b.height*k;c={aspectRatio:k,naturalWidth:c,naturalHeight:d,width:a,height:g};c.left=(b.width-a)/2;c.top=(b.height-g)/2;c.oldLeft=c.left;c.oldTop=c.top;this.canvasData=c;this.limited=1===e||2===e;this.limitCanvas(!0,!0);this.initialImageData=u({},f);this.initialCanvasData=u({},c)},limitCanvas:function(b,f){var e=this.options,a=this.containerData,c=this.canvasData,d=this.cropBoxData,k=e.viewMode,g=c.aspectRatio,h=this.cropped&&d;b&&(b=Number(e.minCanvasWidth)||
0,e=Number(e.minCanvasHeight)||0,1<k?(b=Math.max(b,a.width),e=Math.max(e,a.height),3===k&&(e*g>b?b=e*g:e=b/g)):0<k&&(b?b=Math.max(b,h?d.width:0):e?e=Math.max(e,h?d.height:0):h&&(b=d.width,e=d.height,e*g>b?b=e*g:e=b/g)),g=K({aspectRatio:g,width:b,height:e}),b=g.width,e=g.height,c.minWidth=b,c.minHeight=e,c.maxWidth=Infinity,c.maxHeight=Infinity);f&&(k?(f=a.width-c.width,g=a.height-c.height,c.minLeft=Math.min(0,f),c.minTop=Math.min(0,g),c.maxLeft=Math.max(0,f),c.maxTop=Math.max(0,g),h&&this.limited&&
(c.minLeft=Math.min(d.left,d.left+(d.width-c.width)),c.minTop=Math.min(d.top,d.top+(d.height-c.height)),c.maxLeft=d.left,c.maxTop=d.top,2===k&&(c.width>=a.width&&(c.minLeft=Math.min(0,f),c.maxLeft=Math.max(0,f)),c.height>=a.height&&(c.minTop=Math.min(0,g),c.maxTop=Math.max(0,g))))):(c.minLeft=-c.width,c.minTop=-c.height,c.maxLeft=a.width,c.maxTop=a.height))},renderCanvas:function(b,f){var e=this.canvasData,a=this.imageData;if(f){f=a.naturalWidth*Math.abs(a.scaleX||1);var c=a.naturalHeight*Math.abs(a.scaleY||
1);a=a.rotate||0;a=Math.abs(a)%180;if(90===a)c={width:c,height:f};else{var d=a%90*Math.PI/180,k=Math.sin(d),g=Math.cos(d);d=f*g+c*k;f=f*k+c*g;c=90<a?{width:f,height:d}:{width:d,height:f}}f=c.width;c=c.height;a=f/e.naturalWidth*e.width;k=c/e.naturalHeight*e.height;e.left-=(a-e.width)/2;e.top-=(k-e.height)/2;e.width=a;e.height=k;e.aspectRatio=f/c;e.naturalWidth=f;e.naturalHeight=c;this.limitCanvas(!0,!1)}if(e.width>e.maxWidth||e.width<e.minWidth)e.left=e.oldLeft;if(e.height>e.maxHeight||e.height<e.minHeight)e.top=
e.oldTop;e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth);e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight);this.limitCanvas(!1,!0);e.left=Math.min(Math.max(e.left,e.minLeft),e.maxLeft);e.top=Math.min(Math.max(e.top,e.minTop),e.maxTop);e.oldLeft=e.left;e.oldTop=e.top;r(this.canvas,u({width:e.width,height:e.height},N({translateX:e.left,translateY:e.top})));this.renderImage(b);this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(b){var f=this.canvasData,e=
this.imageData,a=f.width/f.naturalWidth*e.naturalWidth,c=f.height/f.naturalHeight*e.naturalHeight;u(e,{width:a,height:c,left:(f.width-a)/2,top:(f.height-c)/2});r(this.image,u({width:e.width,height:e.height},N(u({translateX:e.left,translateY:e.top},e))));b&&this.output()},initCropBox:function(){var b=this.options,f=this.canvasData,e=b.aspectRatio;b=Number(b.autoCropArea)||.8;var a={width:f.width,height:f.height};e&&(f.height*e>f.width?a.height=a.width/e:a.width=a.height*e);this.cropBoxData=a;this.limitCropBox(!0,
!0);a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth);a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight);a.width=Math.max(a.minWidth,a.width*b);a.height=Math.max(a.minHeight,a.height*b);a.left=f.left+(f.width-a.width)/2;a.top=f.top+(f.height-a.height)/2;a.oldLeft=a.left;a.oldTop=a.top;this.initialCropBoxData=u({},a)},limitCropBox:function(b,f){var e=this.options,a=this.containerData,c=this.canvasData,d=this.cropBoxData,k=this.limited,g=e.aspectRatio;if(b){b=Number(e.minCropBoxWidth)||
0;e=Number(e.minCropBoxHeight)||0;var h=Math.min(a.width,k?c.width:a.width),l=Math.min(a.height,k?c.height:a.height);b=Math.min(b,a.width);e=Math.min(e,a.height);g&&(b&&e?e*g>b?e=b/g:b=e*g:b?e=b/g:e&&(b=e*g),l*g>h?l=h/g:h=l*g);d.minWidth=Math.min(b,h);d.minHeight=Math.min(e,l);d.maxWidth=h;d.maxHeight=l}f&&(k?(d.minLeft=Math.max(0,c.left),d.minTop=Math.max(0,c.top),d.maxLeft=Math.min(a.width,c.left+c.width)-d.width,d.maxTop=Math.min(a.height,c.top+c.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=
a.width-d.width,d.maxTop=a.height-d.height))},renderCropBox:function(){var b=this.options,f=this.containerData,a=this.cropBoxData;if(a.width>a.maxWidth||a.width<a.minWidth)a.left=a.oldLeft;if(a.height>a.maxHeight||a.height<a.minHeight)a.top=a.oldTop;a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth);a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight);this.limitCropBox(!1,!0);a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft);a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop);a.oldLeft=
a.left;a.oldTop=a.top;b.movable&&b.cropBoxMovable&&L(this.face,"action",a.width>=f.width&&a.height>=f.height?"move":"all");r(this.cropBox,u({width:a.width,height:a.height},N({translateX:a.left,translateY:a.top})));this.cropped&&this.limited&&this.limitCanvas(!0,!0);this.disabled||this.output()},output:function(){this.preview();M(this.element,"crop",this.getData())}},{initPreview:function(){var b=this.crossOrigin,a=this.options.preview,e=b?this.crossOriginUrl:this.url,c=document.createElement("img");
b&&(c.crossOrigin=b);c.src=e;this.viewBox.appendChild(c);this.viewBoxImage=c;a&&(c=a,"string"===typeof a?c=this.element.ownerDocument.querySelectorAll(a):a.querySelector&&(c=[a]),this.previews=c,l(c,function(a){var f=document.createElement("img");L(a,"preview",{width:a.offsetWidth,height:a.offsetHeight,html:a.innerHTML});b&&(f.crossOrigin=b);f.src=e;f.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';
a.innerHTML="";a.appendChild(f)}))},resetPreview:function(){l(this.previews,function(b){var a=J(b,"preview");r(b,{width:a.width,height:a.height});b.innerHTML=a.html;O(b,"preview")})},preview:function(){var b=this.imageData,a=this.canvasData,e=this.cropBoxData,c=e.width,d=e.height,k=b.width,g=b.height,h=e.left-a.left-b.left,p=e.top-a.top-b.top;this.cropped&&!this.disabled&&(r(this.viewBoxImage,u({width:k,height:g},N(u({translateX:-h,translateY:-p},b)))),l(this.previews,function(a){var f=J(a,"preview"),
e=f.width;f=f.height;var m=e,l=f,C=1;c&&(C=e/c,l=d*C);d&&l>f&&(C=f/d,m=c*C,l=f);r(a,{width:m,height:l});r(a.getElementsByTagName("img")[0],u({width:k*C,height:g*C},N(u({translateX:-h*C,translateY:-p*C},b))))}))}},{bind:function(){var b=this.element,a=this.options,e=this.cropper;h(a.cropstart)&&F(b,"cropstart",a.cropstart);h(a.cropmove)&&F(b,"cropmove",a.cropmove);h(a.cropend)&&F(b,"cropend",a.cropend);h(a.crop)&&F(b,"crop",a.crop);h(a.zoom)&&F(b,"zoom",a.zoom);F(e,aa,this.onCropStart=this.cropStart.bind(this));
a.zoomable&&a.zoomOnWheel&&F(e,"wheel mousewheel DOMMouseScroll",this.onWheel=this.wheel.bind(this));a.toggleDragModeOnDblclick&&F(e,"dblclick",this.onDblclick=this.dblclick.bind(this));F(b.ownerDocument,ba,this.onCropMove=this.cropMove.bind(this));F(b.ownerDocument,ca,this.onCropEnd=this.cropEnd.bind(this));a.responsive&&F(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var b=this.element,a=this.options,e=this.cropper;h(a.cropstart)&&G(b,"cropstart",a.cropstart);h(a.cropmove)&&
G(b,"cropmove",a.cropmove);h(a.cropend)&&G(b,"cropend",a.cropend);h(a.crop)&&G(b,"crop",a.crop);h(a.zoom)&&G(b,"zoom",a.zoom);G(e,aa,this.onCropStart);a.zoomable&&a.zoomOnWheel&&G(e,"wheel mousewheel DOMMouseScroll",this.onWheel);a.toggleDragModeOnDblclick&&G(e,"dblclick",this.onDblclick);G(b.ownerDocument,ba,this.onCropMove);G(b.ownerDocument,ca,this.onCropEnd);a.responsive&&G(window,"resize",this.onResize)}},{resize:function(){var b=this.options,a=this.container,e=this.containerData,c=Number(b.minContainerWidth)||
200,d=Number(b.minContainerHeight)||100;if(!(this.disabled||e.width<=c||e.height<=d)){var k=a.offsetWidth/e.width;if(1!==k||a.offsetHeight!==e.height){var g=void 0,h=void 0;b.restore&&(g=this.getCanvasData(),h=this.getCropBoxData());this.render();b.restore&&(this.setCanvasData(l(g,function(b,a){g[a]=b*k})),this.setCropBoxData(l(h,function(b,a){h[a]=b*k})))}}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(z(this.dragBox,"cropper-crop")?"move":"crop")},wheel:function(b){var a=
this,e=Number(this.options.wheelZoomRatio)||.1,c=1;this.disabled||(b.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),b.deltaY?c=0<b.deltaY?1:-1:b.wheelDelta?c=-b.wheelDelta/120:b.detail&&(c=0<b.detail?1:-1),this.zoom(-c*e,b)))},cropStart:function(b){if(!this.disabled){var a=this.options,c=this.pointers,d=void 0;b.changedTouches?l(b.changedTouches,function(b){c[b.identifier]=P(b)}):c[b.pointerId||0]=P(b);d=1<Object.keys(c).length&&a.zoomable&&a.zoomOnTouch?
"zoom":J(b.target,"action");ta.test(d)&&!1!==M(this.element,"cropstart",{originalEvent:b,action:d})&&(b.preventDefault(),this.action=d,this.cropping=!1,"crop"===d&&(this.cropping=!0,t(this.dragBox,"cropper-modal")))}},cropMove:function(b){var a=this.action;if(!this.disabled&&a){var c=this.pointers;b.preventDefault();!1!==M(this.element,"cropmove",{originalEvent:b,action:a})&&(b.changedTouches?l(b.changedTouches,function(b){u(c[b.identifier],P(b,!0))}):u(c[b.pointerId||0],P(b,!0)),this.change(b))}},
cropEnd:function(b){if(!this.disabled){var a=this.action,c=this.pointers;b.changedTouches?l(b.changedTouches,function(b){delete c[b.identifier]}):delete c[b.pointerId||0];a&&(b.preventDefault(),Object.keys(c).length||(this.action=""),this.cropping&&(this.cropping=!1,y(this.dragBox,"cropper-modal",this.cropped&&this.options.modal)),M(this.element,"cropend",{originalEvent:b,action:a}))}}},{change:function(b){var a=this.canvasData,c=this.containerData,d=this.cropBoxData,k=this.pointers,g=this.action,
h=this.options.aspectRatio,p=d.left,r=d.top,q=d.width,n=d.height,A=p+q,t=r+n,z=0,x=0,u=c.width,B=c.height,y=!0,D=void 0;!h&&b.shiftKey&&(h=q&&n?q/n:1);this.limited&&(z=d.minLeft,x=d.minTop,u=z+Math.min(c.width,a.width,a.left+a.width),B=x+Math.min(c.height,a.height,a.top+a.height));a=k[Object.keys(k)[0]];var w=a.endX-a.startX,v=a.endY-a.startY;D=function(b){switch(b){case "e":A+w>u&&(w=u-A);break;case "w":p+w<z&&(w=z-p);break;case "n":r+v<x&&(v=x-r);break;case "s":t+v>B&&(v=B-t)}};switch(g){case "all":p+=
w;r+=v;break;case "e":if(0<=w&&(A>=u||h&&(r<=x||t>=B))){y=!1;break}D("e");q+=w;h&&(n=q/h,r-=w/h/2);0>q&&(g="w",q=0);break;case "n":if(0>=v&&(r<=x||h&&(p<=z||A>=u))){y=!1;break}D("n");n-=v;r+=v;h&&(q=n*h,p+=v*h/2);0>n&&(g="s",n=0);break;case "w":if(0>=w&&(p<=z||h&&(r<=x||t>=B))){y=!1;break}D("w");q-=w;p+=w;h&&(n=q/h,r+=w/h/2);0>q&&(g="e",q=0);break;case "s":if(0<=v&&(t>=B||h&&(p<=z||A>=u))){y=!1;break}D("s");n+=v;h&&(q=n*h,p-=v*h/2);0>n&&(g="n",n=0);break;case "ne":if(h){if(0>=v&&(r<=x||A>=u)){y=!1;
break}D("n");n-=v;r+=v;q=n*h}else D("n"),D("e"),0<=w?A<u?q+=w:0>=v&&r<=x&&(y=!1):q+=w,0>=v?r>x&&(n-=v,r+=v):(n-=v,r+=v);0>q&&0>n?(g="sw",q=n=0):0>q?(g="nw",q=0):0>n&&(g="se",n=0);break;case "nw":if(h){if(0>=v&&(r<=x||p<=z)){y=!1;break}D("n");n-=v;r+=v;q=n*h;p+=v*h}else D("n"),D("w"),0>=w?p>z?(q-=w,p+=w):0>=v&&r<=x&&(y=!1):(q-=w,p+=w),0>=v?r>x&&(n-=v,r+=v):(n-=v,r+=v);0>q&&0>n?(g="se",q=n=0):0>q?(g="ne",q=0):0>n&&(g="sw",n=0);break;case "sw":if(h){if(0>=w&&(p<=z||t>=B)){y=!1;break}D("w");q-=w;p+=w;
n=q/h}else D("s"),D("w"),0>=w?p>z?(q-=w,p+=w):0<=v&&t>=B&&(y=!1):(q-=w,p+=w),0<=v?t<B&&(n+=v):n+=v;0>q&&0>n?(g="ne",q=n=0):0>q?(g="se",q=0):0>n&&(g="nw",n=0);break;case "se":if(h){if(0<=w&&(A>=u||t>=B)){y=!1;break}D("e");q+=w;n=q/h}else D("s"),D("e"),0<=w?A<u?q+=w:0<=v&&t>=B&&(y=!1):q+=w,0<=v?t<B&&(n+=v):n+=v;0>q&&0>n?(g="nw",q=n=0):0>q?(g="sw",q=0):0>n&&(g="ne",n=0);break;case "move":this.move(w,v);y=!1;break;case "zoom":this.zoom(ma(k),b);y=!1;break;case "crop":w&&v?(D=U(this.cropper),p=a.startX-
D.left,r=a.startY-D.top,q=d.minWidth,n=d.minHeight,0<w?g=0<v?"se":"ne":0>w&&(p-=q,g=0<v?"sw":"nw"),0>v&&(r-=n),this.cropped||(E(this.cropBox,"cropper-hidden"),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))):y=!1}y&&(d.width=q,d.height=n,d.left=p,d.top=r,this.action=g,this.renderCropBox());l(k,function(b){b.startX=b.endX;b.startY=b.endY})}},{crop:function(){!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&t(this.dragBox,"cropper-modal"),
E(this.cropBox,"cropper-hidden"),this.setCropBoxData(this.initialCropBoxData));return this},reset:function(){this.ready&&!this.disabled&&(this.imageData=u({},this.initialImageData),this.canvasData=u({},this.initialCanvasData),this.cropBoxData=u({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox());return this},clear:function(){this.cropped&&!this.disabled&&(u(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),
this.renderCanvas(),E(this.dragBox,"cropper-modal"),t(this.cropBox,"cropper-hidden"));return this},replace:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;!this.disabled&&b&&(this.isImg&&(this.element.src=b),a?(this.url=b,this.image.src=b,this.ready&&(this.viewBoxImage.src=b,l(this.previews,function(a){a.getElementsByTagName("img")[0].src=b}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(b)));return this},enable:function(){this.ready&&
this.disabled&&(this.disabled=!1,E(this.cropper,"cropper-disabled"));return this},disable:function(){this.ready&&!this.disabled&&(this.disabled=!0,t(this.cropper,"cropper-disabled"));return this},destroy:function(){var b=this.element;if(!J(b,"cropper"))return this;this.isImg&&this.replaced&&(b.src=this.originalUrl);this.uncreate();O(b,"cropper");return this},move:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:b,c=this.canvasData,d=c.left;c=c.top;return this.moveTo(g(b)?b:
d+Number(b),g(a)?a:c+Number(a))},moveTo:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:b,e=this.canvasData,d=!1;b=Number(b);a=Number(a);this.ready&&!this.disabled&&this.options.movable&&(c(b)&&(e.left=b,d=!0),c(a)&&(e.top=a,d=!0),d&&this.renderCanvas(!0));return this},zoom:function(b,a){var c=this.canvasData;b=Number(b);return this.zoomTo(c.width*(0>b?1/(1-b):1+b)/c.naturalWidth,null,a)},zoomTo:function(b,a,e){var f=this.options,d=this.canvasData,g=d.width,h=d.height,l=d.naturalWidth,
p=d.naturalHeight;b=Number(b);if(0<=b&&this.ready&&!this.disabled&&f.zoomable){f=l*b;b*=p;if(!1===M(this.element,"zoom",{originalEvent:e,oldRatio:g/l,ratio:f/l}))return this;e?(l=this.pointers,a=U(this.cropper),e=l&&Object.keys(l).length?na(l):{pageX:e.pageX,pageY:e.pageY},d.left-=(e.pageX-a.left-d.left)/g*(f-g),d.top-=(e.pageY-a.top-d.top)/h*(b-h)):k(a)&&c(a.x)&&c(a.y)?(d.left-=(a.x-d.left)/g*(f-g),d.top-=(a.y-d.top)/h*(b-h)):(d.left-=(f-g)/2,d.top-=(b-h)/2);d.width=f;d.height=b;this.renderCanvas(!0)}return this},
rotate:function(b){return this.rotateTo((this.imageData.rotate||0)+Number(b))},rotateTo:function(b){b=Number(b);c(b)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=b%360,this.renderCanvas(!0,!0));return this},scaleX:function(b){var a=this.imageData.scaleY;return this.scale(b,c(a)?a:1)},scaleY:function(b){var a=this.imageData.scaleX;return this.scale(c(a)?a:1,b)},scale:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:b,e=this.imageData,d=!1;b=Number(b);
a=Number(a);this.ready&&!this.disabled&&this.options.scalable&&(c(b)&&(e.scaleX=b,d=!0),c(a)&&(e.scaleY=a,d=!0),d&&this.renderCanvas(!0,!0));return this},getData:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,a=this.options,c=this.imageData,d=this.canvasData,g=this.cropBoxData,k=void 0;if(this.ready&&this.cropped){k={x:g.left-d.left,y:g.top-d.top,width:g.width,height:g.height};var h=c.width/c.naturalWidth;l(k,function(a,c){a/=h;k[c]=b?Math.round(a):a})}else k={x:0,y:0,
width:0,height:0};a.rotatable&&(k.rotate=c.rotate||0);a.scalable&&(k.scaleX=c.scaleX||1,k.scaleY=c.scaleY||1);return k},setData:function(b){var a=this.options,e=this.imageData,d=this.canvasData,g={};if(this.ready&&!this.disabled&&k(b)){var h=!1;a.rotatable&&c(b.rotate)&&b.rotate!==e.rotate&&(e.rotate=b.rotate,h=!0);a.scalable&&(c(b.scaleX)&&b.scaleX!==e.scaleX&&(e.scaleX=b.scaleX,h=!0),c(b.scaleY)&&b.scaleY!==e.scaleY&&(e.scaleY=b.scaleY,h=!0));h&&this.renderCanvas(!0,!0);a=e.width/e.naturalWidth;
c(b.x)&&(g.left=b.x*a+d.left);c(b.y)&&(g.top=b.y*a+d.top);c(b.width)&&(g.width=b.width*a);c(b.height)&&(g.height=b.height*a);this.setCropBoxData(g)}return this},getContainerData:function(){return this.ready?u({},this.containerData):{}},getImageData:function(){return this.sized?u({},this.imageData):{}},getCanvasData:function(){var a=this.canvasData,c={};this.ready&&l("left top width height naturalWidth naturalHeight".split(" "),function(b){c[b]=a[b]});return c},setCanvasData:function(a){var b=this.canvasData,
e=b.aspectRatio;this.ready&&!this.disabled&&k(a)&&(c(a.left)&&(b.left=a.left),c(a.top)&&(b.top=a.top),c(a.width)?(b.width=a.width,b.height=a.width/e):c(a.height)&&(b.height=a.height,b.width=a.height*e),this.renderCanvas(!0));return this},getCropBoxData:function(){var a=this.cropBoxData,c=void 0;this.ready&&this.cropped&&(c={left:a.left,top:a.top,width:a.width,height:a.height});return c||{}},setCropBoxData:function(a){var b=this.cropBoxData,e=this.options.aspectRatio,d=void 0,g=void 0;this.ready&&
this.cropped&&!this.disabled&&k(a)&&(c(a.left)&&(b.left=a.left),c(a.top)&&(b.top=a.top),c(a.width)&&a.width!==b.width&&(d=!0,b.width=a.width),c(a.height)&&a.height!==b.height&&(g=!0,b.height=a.height),e&&(d?b.height=b.width/e:g&&(b.width=b.height*e)),this.renderCropBox());return this},getCroppedCanvas:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var c=this.canvasData,e=pa(this.image,this.imageData,c,a);if(!this.cropped)return e;
var d=this.getData(),g=d.x,k=d.y,h=d.width;d=d.height;c=e.width/Math.floor(c.naturalWidth);1!==c&&(g*=c,k*=c,h*=c,d*=c);var l=h/d,p=K({aspectRatio:l,width:a.maxWidth||Infinity,height:a.maxHeight||Infinity}),r=K({aspectRatio:l,width:a.minWidth||0,height:a.minHeight||0},"cover");l=K({aspectRatio:l,width:a.width||(1!==c?e.width:h),height:a.height||(1!==c?e.height:d)});c=l.width;l=l.height;c=Math.min(p.width,Math.max(r.width,c));l=Math.min(p.height,Math.max(r.height,l));p=document.createElement("canvas");
r=p.getContext("2d");p.width=A(c);p.height=A(l);r.fillStyle=a.fillColor||"transparent";r.fillRect(0,0,c,l);l=a.imageSmoothingEnabled;a=a.imageSmoothingQuality;r.imageSmoothingEnabled=void 0===l?!0:l;a&&(r.imageSmoothingQuality=a);a=e.width;l=e.height;var n=g,t=k,z=void 0,B=void 0,u=g=k=void 0,y=void 0;n<=-h||n>a?u=k=z=n=0:0>=n?(k=-n,n=0,u=z=Math.min(a,h+n)):n<=a&&(k=0,u=z=Math.min(h,a-n));0>=z||t<=-d||t>l?y=g=B=t=0:0>=t?(g=-t,t=0,y=B=Math.min(l,d+t)):t<=l&&(g=0,y=B=Math.min(d,l-t));d=[n,t,z,B];0<
u&&0<y&&(h=c/h,d.push(k*h,g*h,u*h,y*h));r.drawImage.apply(r,[e].concat(X(d.map(function(a){return Math.floor(A(a))}))));return p},setAspectRatio:function(a){var b=this.options;this.disabled||g(a)||(b.aspectRatio=Math.max(0,a)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox()));return this},setDragMode:function(a){var b=this.options,c=this.dragBox,d=this.face;if(this.ready&&!this.disabled){var g="crop"===a,k=b.movable&&"move"===a;a=g||k?a:"none";b.dragMode=a;L(c,"action",a);y(c,
"cropper-crop",g);y(c,"cropper-move",k);b.cropBoxMovable||(L(d,"action",a),y(d,"cropper-crop",g),y(d,"cropper-move",k))}return this}});if(d.fn){var za=d.fn.cropper;d.fn.cropper=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),g=1;g<b;g++)c[g-1]=arguments[g];var k=void 0;this.each(function(b,e){b=d(e);var g="destroy"===a,f=b.data("cropper");if(!f){if(g)return;f=d.extend({},b.data(),d.isPlainObject(a)&&a);f=new Q(e,f);b.data("cropper",f)}"string"===typeof a&&(e=f[a],d.isFunction(e)&&(k=e.apply(f,
c),k===f&&(k=void 0),g&&b.removeData("cropper")))});return void 0!==k?k:this};d.fn.cropper.Constructor=Q;d.fn.cropper.setDefaults=Q.setDefaults;d.fn.cropper.noConflict=function(){d.fn.cropper=za;return this}}})});
Module.define("htmlformat",["jquery"],function(h){function d(a){var d=[];c(a,d);d.forEach(function(a){for(var c=0;c<a.split.length;c+=2){var d=document.createTextNode(a.split[c]);a.parent.insertBefore(d,a.node);c+1<a.split.length&&a.parent.insertBefore(k("\x3ca/\x3e").text(a.split[c+1]).attr("href",a.prefix+a.split[c+1])[0],a.node)}});d.forEach(function(a){try{a.parent.removeChild(a.node)}catch(z){}})}function c(a,d){if("A"!==a.nodeName)for(var g=0;g<a.childNodes.length;++g){var k=a.childNodes[g];
if(3==k.nodeType){var h=k.nodeValue.split(/((?:\bhttps?:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])|(?:\bwww\.[\S]+))/gim);1<h.length&&d.push({node:k,split:h,parent:k.parentNode,prefix:""})}else 1==k.nodeType&&c(k,d)}}function g(a){for(;a.attributes.length;)a.removeAttribute(a.attributes[0].name);return!0}function a(a,c){for(var d=a.attributes.length-1;0<=d;d--){var g=a.attributes[d],k=c[g.name];!0===k||"function"===typeof k&&k(g.value)||a.removeAttribute(g.name)}return!0}var k=jQuery,p=
this.defaults={brformat:!0,linkformat:!0,tags:{A:function(c){if(a(c,{href:function(a){return a.startsWith("http")||a.startsWith("https")||a.startsWith("/")}}))return c.setAttribute("rel","nofollow noindex"),!0},P:g,BR:g,STRONG:g,B:g,I:g,BLOCKQUOTE:g,SUB:g,SUP:g,STRIKE:g}};this.format=function(a,c){if(!a||!a.length)return"";c||(c=p);a=jQuery("\x3cdiv/\x3e").html(a);c.linkformat&&d(a[0]);a.find("*").each(function(){var a=c.tags[this.nodeName];"function"===typeof a&&a(this)||k(this).remove()});return c.brformat?
a.html().replace(/\n/g,"\x3cbr/\x3e"):a.html()}});
Module.define("nativedatepicker",["jquery","date","/css/native-date-time.css"],function(h){function d(c){var g=c=void 0===c?{}:c,a=g.cbDateChange,k=g.clsSelector;c=g.initDateStr;g=g.jElement;this.inputDateEl=this.dateStr=this.cbDateChange=void 0;this.status=!0;this.today=new Date;if(g||k){this.cbDateChange="function"===typeof a?a:void 0;if(g&&g.addClass&&g.val)this.inputDateEl=g;else if((a=$(k))&&0<a.length)this.inputDateEl=a.first();else{d.logError("NativeDatePicker","Failed to initialize NativeDatePicker. It can not locate INPUT[type\x3ddate] element.");
this.status=!1;return}c=c||this.inputDateEl.val();if(d.REGEX_YYYY_MM_DD.test(c)||d.REGEX_YYYYYY_MM_DD.test(c)){a=this.inputDateEl.prop("min");k=this.inputDateEl.prop("max");g=""===a?0:d.getEpochMilliFromBrowserDateStr(a);var h=""===a?0:d.getEpochMilliFromBrowserDateStr(k),l=d.getEpochMilliFromBrowserDateStr(c);this.dateStr=0<g&&g>l?a:0<h&&h<l?k:c}else this.dateStr=d.getBrowserDateStrFromDate(this.today),d.logWarning("NativeDatePicker","No initial date value detected.  Using today's date to derive intial value.");
this.inputDateEl.addClass(d.CSS_CLS);this.inputDateEl.val(this.dateStr);this.inputDateEl.on("change",this.changeEventHandler.bind(this))}else d.logError("NativeDatePicker","Failed to initialize NativeDatePicker. No jQuery element or selector specified."),this.status=!1}d.prototype.changeEventHandler=function(c){c.preventDefault();this.processValueChange()};d.prototype.processValueChange=function(){this.dateStr=this.inputDateEl.val();this.cbDateChange&&this.cbDateChange()};d.prototype.dismount=function(){this.inputDateEl.off("change")};
d.prototype.getValue=function(){return d.getDateFromBrowserDateStr(this.dateStr)};d.prototype.getValueInMilli=function(){return d.getEpochMilliFromBrowserDateStr(this.dateStr)};d.prototype.getStatus=function(){return this.status};d.REGEX_YYYY_MM_DD=/^[\d]{4}-[\d]{2}-[\d]{2}$/;d.REG_MM_DD_YYYY_WITH_SLASH=/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/;d.REGEX_YYYYYY_MM_DD=/^[\d]{6}-[\d]{2}-[\d]{2}$/;d.CSS_CLS="native-date-time";d.getBrowserDateStrFromDate=function(c){if(Date.isValidDate(c)&&c.format)return c.format("yyyy-mm-dd");
d.logWarning("NativeDatePicker","Invalid data: "+c+" (expecting Date object).");return null};d.getBrowserDateStrFromYYYYMMDD=function(c){c=void 0===c?"":c;if(/^\d{8}$/.test(c))return c+="",c.slice(0,4)+"-"+c.slice(4,6)+"-"+c.slice(6);d.logWarning("NativeDatePicker","Invalid data: "+c+" (expecting yyyymmdd).");return null};d.getDateFromBrowserDateStr=function(c){c=void 0===c?"":c;if(d.REGEX_YYYY_MM_DD.test(c)||d.REGEX_YYYYYY_MM_DD.test(c)){var g=c.split("-");c=parseInt(g[0]);var a=parseInt(g[1])-1;
g=parseInt(g[2]);return new Date(c,a,g)}d.logWarning("NativeDatePicker","Invalid data: "+c+" (expecting YYYY-MM-DD).");return null};d.getEpochMilliFromBrowserDateStr=function(c){c=d.getDateFromBrowserDateStr(void 0===c?"":c);return null!=c?c.getTime():0};d.getBrowserDateStrFromMMDDYYYYWithSlash=function(c){c=void 0===c?"":c;if(d.REG_MM_DD_YYYY_WITH_SLASH.test(c)){c=$jscomp.makeIterator(c.split("/"));var g=c.next().value,a=c.next().value;return c.next().value+"-"+g+"-"+a}console.error("getBrowserDateStrFromMMDDYYYYWithSlash",
"Invalid input "+c+".");return null};d.getMMDDYYYYWithSlashFromBrowserDateStr=function(c){c=void 0===c?"":c;if(d.REGEX_YYYY_MM_DD.test(c)){var g=$jscomp.makeIterator(c.split("-"));c=g.next().value;var a=g.next().value;g=g.next().value;return a+"/"+g+"/"+c}console.error("getBrowserDateStrFromMMDDYYYYWithSlash","Invalid input "+c+".");return null};d.logWarning=function(c){for(var d=[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.warn(d)};d.logError=function(c){for(var d=[],a=0;a<arguments.length;++a)d[a-
0]=arguments[a];console.error(d)};h.initNativeDatePicker=function(c){return new Promise(function(g){jQuery(function(a){this.$=a;a=d.bind(this);g(new a(c))})})};return d});
Module.define("nativedatetime",["jquery","nativedatepicker","nativetimepicker"],function(h){function d(c){c=void 0===c?{}:c;var g=window.modules,a=g.nativedatepicker;g=g.nativetimepicker;var k=c,h=k.cbChange,l=k.datePickerElement,A=k.datePickerSelector,r=k.initDateStr,z=k.timePickerElement,t=k.timePickerSelector,E=k.initTimeStr,y=k.storeAtElement,B=k.storeAtSelector;c=void 0===k.storeAtAttrName?d.STORE_AT_DATA_ATTR:k.storeAtAttrName;var J=k.parentElement;k=k.parentSelector;this.parentEl=this.timeInMilli=
this.dateInMilli=this.storeAtAttrName=this.storeAt=this.timePicker=this.datePicker=this.cbChange=void 0;this.status=!0;this.cbChange="function"===typeof h?h:void 0;this.datePicker=new a({cbDateChange:this.cbDateChange.bind(this),cssSelector:A,initDateStr:r,jElement:l});this.timePicker=new g({cbTimeChange:this.cbTimeChange.bind(this),cssSelector:t,initTimeStr:E,jElement:z});if(this.datePicker.getStatus()&&this.timePicker.getStatus()){this.dateInMilli=this.datePicker.getValueInMilli();this.timeInMilli=
this.timePicker.getValueInMilli();if(y||B)y?this.storeAt=y:(a=$(B))&&0<a.length&&(this.storeAt=a[0]),this.storeAtAttrName=c,this.applyDataStoreAt();if(J||k)J?this.parentEl=J:(a=$(k))&&0<a.length&&(this.parentEl=a[0])}else d.logError("NativeDateTime","Failed to initialize either one or both of date and time pickers."),this.status=!1}d.prototype.applyDataStoreAt=function(){if(this.storeAt){var c=this.getValueInMilli();this.storeAt.attr(this.storeAtAttrName,c)}};d.prototype.cbDateChange=function(){this.dateInMilli=
this.datePicker.getValueInMilli();this.applyDataStoreAt();this.cbChange&&this.cbChange()};d.prototype.cbTimeChange=function(){this.timeInMilli=this.timePicker.getValueInMilli();this.applyDataStoreAt();this.cbChange&&this.cbChange()};d.prototype.processValueChange=function(){this.datePicker.processValueChange();this.timePicker.processValueChange()};d.prototype.getValueInMilli=function(){return this.dateInMilli+this.timeInMilli};d.prototype.getParentEl=function(){return this.parentEl};d.prototype.getStatus=
function(){return this.status};d.prototype.dismount=function(){this.datePicker.dismount();this.timePicker.dismount()};d.STORE_AT_DATA_ATTR="data-datetime";d.logWarning=function(c){for(var d=[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.warn(d)};d.logError=function(c){for(var d=[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.error(d)};h.initNativeDateTime=function(c){return new Promise(function(g){jQuery(function(a){this.$=a;a=d.bind(this);g(new a(c))})})};return d});
Module.define("nativefromtodatetime",["jquery","nativedatetime"],function(h){function d(c){c=void 0===c?{}:c;var g=window.modules.nativedatetime,a=c;c=a.cbWhenErrorFree;var k=a.cbWhenErrorOccurs,h=a.configFrom;a=a.configTo;this.dataAreValid=!0;this.toNativeDateTime=this.fromNativeDateTime=void 0;this.status=!0;this.cbWhenErrorOccurs=this.cbWhenErrorFree=void 0;if(h&&a){var l=this.cbChange.bind(this);this.cbWhenErrorFree="function"===typeof c?c:void 0;this.cbWhenErrorOccurs="function"===typeof k?k:
void 0;this.fromNativeDateTime=new g(Object.assign({},{cbChange:l},h));this.toNativeDateTime=new g(Object.assign({},{cbChange:l},a));this.fromNativeDateTime.getStatus()&&this.toNativeDateTime.getStatus()?this.validate():(d.logError("NativeFromToDateTime",'Failed to initialize either "from" or "to" NativeDateTime: '+this.fromNativeDateTime+"-"+this.toNativeDateTime),this.status=!1)}else d.logError("NativeFromToDateTime","Config parameters are missing... Failed to initialize: "+a+"-"+h),this.status=
!1}d.prototype.validate=function(){var c=this,g=this.fromNativeDateTime,a=this.toNativeDateTime,k=g.getValueInMilli(),h=a.getValueInMilli(),l=g.getParentEl(),A=a.getParentEl();g=function(a){a=void 0===a?"":a;c.cbWhenErrorOccurs&&c.cbWhenErrorOccurs();l&&l.addClass(a);A&&A.addClass(a)};a=function(a){a=void 0===a?"":a;c.cbWhenErrorFree&&c.cbWhenErrorFree();l&&l.removeClass(a);A&&A.removeClass(a)};Number.isInteger(k)&&1<k&&Number.isInteger(h)&&1<h?(this.dataAreValid=!0,a(d.ERROR_NDT_INVALID),k>h?(this.dataAreValid=
!1,g(d.ERROR_NDT_MIN_MAX),d.logWarning('Date and time of "from" is later than "to".')):(this.dataAreValid=!0,a(d.ERROR_NDT_MIN_MAX))):(this.dataAreValid=!1,g(d.ERROR_NDT_INVALID),d.logWarning("Date and time data are not valid."))};d.prototype.cbChange=function(){this.validate()};d.prototype.processValueChange=function(){this.fromNativeDateTime.processValueChange();this.toNativeDateTime.processValueChange()};d.prototype.getFromTimeInMilli=function(){return this.fromNativeDateTime.getValueInMilli()};
d.prototype.getToTimeInMilli=function(){return this.toNativeDateTime.getValueInMilli()};d.prototype.getIsDataValid=function(){return this.dataAreValid};d.prototype.dismount=function(){this.fromNativeDateTime.dismount();this.toNativeDateTime.dismount()};d.prototype.getStatus=function(){return this.status};d.ERROR_NDT_MIN_MAX="error-ndt-min-max";d.ERROR_NDT_INVALID="error-ndt-invalid";d.logWarning=function(c){for(var d=[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.warn(d)};d.logError=function(c){for(var d=
[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.error(d)};h.initNativeFromToDateTime=function(c){return new Promise(function(g){jQuery(function(a){this.$=a;a=d.bind(this);g(new a(c))})})};return d});
Module.define("nativetimepicker",["jquery","date","/css/native-date-time.css"],function(h){function d(c){var g=c=void 0===c?{}:c,a=g.cbTimeChange,k=g.clsSelector;c=g.initTimeStr;g=g.jElement;this.inputTimeEl=this.cbTimeChange=void 0;this.status=!0;this.timeStr=void 0;this.today=new Date;if(g||k){this.cbTimeChange="function"===typeof a?a:void 0;if(g&&g.addClass&&g.val)this.inputTimeEl=g;else if((a=$(k))&&0<a.length)this.inputTimeEl=a.first();else{d.logError("NativeTimePicker","Failed to initialize NativeTimePicker. It can not locate INPUT[type\x3dtime] element.");
this.status=!1;return}c=c||this.inputTimeEl.val();d.REGEX_HH_MM.test(c)?this.timeStr=c:(this.timeStr=d.DEFAULT_TIME,d.logWarning("NativeTimePicker","No initial time value detected.  Using default time of 2:00 AM."));this.inputTimeEl.addClass(d.CSS_CLS);this.inputTimeEl.val(this.timeStr);this.inputTimeEl.on("change",this.changeEventHandler.bind(this))}else d.logError("NativeTimePicker","Failed to initialize NativeTimePicker. No selector specified."),this.status=!1}d.prototype.changeEventHandler=function(c){c.preventDefault();
this.processValueChange()};d.prototype.processValueChange=function(){this.timeStr=this.inputTimeEl.val();this.cbTimeChange&&this.cbTimeChange()};d.prototype.dismount=function(){this.inputTimeEl.off("change")};d.prototype.getValueInMilli=function(){return d.getMilliSecondsFromBrowserTimeStr(this.timeStr)};d.prototype.getStatus=function(){return this.status};d.REGEX_HH_MM=/^[\d]{2}:[\d]{2}$/;d.DEFAULT_TIME="02:00";d.CSS_CLS="native-date-time";d.getBrowserTimeStrFromDate=function(c){if(Date.isValidDate(c)&&
c.format)return c.format("HH:MM");d.logWarning("NativeTimePicker","Invalid data: "+c+" (expecting Date object).");return null};d.getMilliSecondsFromBrowserTimeStr=function(c){c=void 0===c?"":c;if(d.REGEX_HH_MM.test(c)){var g=c.split(":");c=parseInt(g[0]);g=parseInt(g[1]);return 1E3*(3600*c+60*g)}d.logWarning("NativeTimePicker","Invalid data: "+c+" (expecting hh:mm).");return null};d.logWarning=function(c){for(var d=[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.warn(d)};d.logError=function(c){for(var d=
[],a=0;a<arguments.length;++a)d[a-0]=arguments[a];console.error(d)};h.initNativeTimePicker=function(c){return new Promise(function(g){jQuery(function(a){this.$=a;a=d.bind(this);g(new a(c))})})};return d});
Module.define("timepicker",["jquery","timepicker.css"],function(){(function(h,d,c){var g=function(a,c){this.$element=h(a);this.defaultTime=c.defaultTime;this.disableFocus=c.disableFocus;this.disableMousewheel=c.disableMousewheel;this.isOpen=c.isOpen;this.minuteStep=c.minuteStep;this.modalBackdrop=c.modalBackdrop;this.orientation=c.orientation;this.secondStep=c.secondStep;this.snapToStep=c.snapToStep;this.showInputs=c.showInputs;this.showMeridian=c.showMeridian;this.showSeconds=c.showSeconds;this.maxHours=
c.maxHours;this.explicitMode=c.explicitMode;this._init()};g.prototype={constructor:g,_init:function(){this.$element.on({"focus.timepicker":h.proxy(this.highlightUnit,this),"click.timepicker":h.proxy(this.highlightUnit,this),"keydown.timepicker":h.proxy(this.elementKeydown,this),"blur.timepicker":h.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":h.proxy(this.mousewheel,this)});this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal()},
clear:function(){this.meridian=this.second=this.minute=this.hour="";this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else 0>=this.hour?this.hour=this.maxHours-1:this.hour--},decrementMinute:function(a){a=a?this.minute-a:this.minute-this.minuteStep;0>a?(this.decrementHour(),this.minute=a+60):this.minute=a},decrementSecond:function(){var a=
this.second-this.secondStep;0>a?(this.decrementMinute(!0),this.second=a+60):this.second=a},elementKeydown:function(a){switch(a.which){case 9:if(a.shiftKey){if("hour"===this.highlightedUnit)break;this.highlightPrevUnit()}else if(this.showMeridian&&"meridian"===this.highlightedUnit||this.showSeconds&&"second"===this.highlightedUnit||!this.showMeridian&&!this.showSeconds&&"minute"===this.highlightedUnit)break;else this.highlightNextUnit();a.preventDefault();this.updateFromElementVal();break;case 27:this.updateFromElementVal();
break;case 37:a.preventDefault();this.highlightPrevUnit();this.updateFromElementVal();break;case 38:a.preventDefault();switch(this.highlightedUnit){case "hour":this.incrementHour();this.highlightHour();break;case "minute":this.incrementMinute();this.highlightMinute();break;case "second":this.incrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:a.preventDefault();this.highlightNextUnit();this.updateFromElementVal();
break;case 40:a.preventDefault();switch(this.highlightedUnit){case "hour":this.decrementHour();this.highlightHour();break;case "minute":this.decrementMinute();this.highlightMinute();break;case "second":this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}this.update()}},getCursorPosition:function(){var a=this.$element.get(0);if("selectionStart"in a)return a.selectionStart;if(c.selection){a.focus();var d=c.selection.createRange(),g=c.selection.createRange().text.length;
d.moveStart("character",-a.value.length);return d.text.length-g}},getTime:function(){return""===this.hour?"":this.hour+":"+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},highlightUnit:function(){this.position=this.getCursorPosition();0<=this.position&&2>=this.position?this.highlightHour():3<=this.position&&5>=this.position?this.highlightMinute():6<=this.position&&
8>=this.position?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&11>=this.position&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case "hour":this.highlightMinute();break;case "minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case "second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case "meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case "hour":this.showMeridian?
this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case "minute":this.highlightHour();break;case "second":this.highlightMinute();break;case "meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var a=this.$element.get(0),c=this;this.highlightedUnit="hour";a.setSelectionRange&&setTimeout(function(){10>c.hour?a.setSelectionRange(0,1):a.setSelectionRange(0,2)},0)},highlightMinute:function(){var a=this.$element.get(0),
c=this;this.highlightedUnit="minute";a.setSelectionRange&&setTimeout(function(){10>c.hour?a.setSelectionRange(2,4):a.setSelectionRange(3,5)},0)},highlightSecond:function(){var a=this.$element.get(0),c=this;this.highlightedUnit="second";a.setSelectionRange&&setTimeout(function(){10>c.hour?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0)},highlightMeridian:function(){var a=this.$element.get(0),c=this;this.highlightedUnit="meridian";a.setSelectionRange&&(this.showSeconds?setTimeout(function(){10>
c.hour?a.setSelectionRange(8,10):a.setSelectionRange(9,11)},0):setTimeout(function(){10>c.hour?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}this.hour===this.maxHours-1?this.hour=0:this.hour++},incrementMinute:function(a){a=a?this.minute+a:this.minute+this.minuteStep-this.minute%this.minuteStep;59<a?(this.incrementHour(),this.minute=a-60):this.minute=a},
incrementSecond:function(){var a=this.second+this.secondStep-this.second%this.secondStep;59<a?(this.incrementMinute(!0),this.second=a-60):this.second=a},mousewheel:function(a){if(!this.disableMousewheel){a.preventDefault();a.stopPropagation();var c=a.originalEvent.wheelDelta||-a.originalEvent.detail,d=null;"mousewheel"===a.type?d=-1*a.originalEvent.wheelDelta:"DOMMouseScroll"===a.type&&(d=40*a.originalEvent.detail);d&&(a.preventDefault(),h(this).scrollTop(d+h(this).scrollTop()));switch(this.highlightedUnit){case "minute":0<
c?this.incrementMinute():this.decrementMinute();this.highlightMinute();break;case "second":0<c?this.incrementSecond():this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian();this.highlightMeridian();break;default:0<c?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},changeToNearestStep:function(a,c){return 0===a%c?a:Math.round(a%c/c)?(a+(c-a%c))%60:a-a%c},remove:function(){h("document").off(".timepicker");delete this.$element.data().timepicker},
setDefaultTime:function(a){if(this.$element.val())this.updateFromElementVal();else if("current"===a){a=new Date;var c=a.getHours(),d=a.getMinutes(),g=a.getSeconds(),h="AM";0!==g&&(g=Math.ceil(a.getSeconds()/this.secondStep)*this.secondStep,60===g&&(d+=1,g=0));0!==d&&(d=Math.ceil(a.getMinutes()/this.minuteStep)*this.minuteStep,60===d&&(c+=1,d=0));this.showMeridian&&(0===c?c=12:12<=c?(12<c&&(c-=12),h="PM"):h="AM");this.hour=c;this.minute=d;this.second=g;this.meridian=h;this.update()}else!1===a?(this.second=
this.minute=this.hour=0,this.meridian="AM"):this.setTime(a)},setTime:function(a){if(a){if("object"===typeof a&&a.getMonth){var c=a.getHours();var d=a.getMinutes();a=a.getSeconds();if(this.showMeridian){var g="AM";12<c&&(g="PM",c%=12);12===c&&(g="PM")}}else{var h=(/a/i.test(a)?1:0)+(/p/i.test(a)?2:0);if(2<h){this.clear();return}a=a.replace(/[^0-9:]/g,"").split(":");c=a[0]?a[0].toString():a.toString();if(this.explicitMode&&2<c.length&&0!==c.length%2){this.clear();return}d=a[1]?a[1].toString():"";a=
a[2]?a[2].toString():"";4<c.length&&(a=c.slice(-2),c=c.slice(0,-2));2<c.length&&(d=c.slice(-2),c=c.slice(0,-2));2<d.length&&(a=d.slice(-2),d=d.slice(0,-2));c=parseInt(c,10);d=parseInt(d,10);a=parseInt(a,10);isNaN(c)&&(c=0);isNaN(d)&&(d=0);isNaN(a)&&(a=0);59<a&&(a=59);59<d&&(d=59);c>=this.maxHours&&(c=this.maxHours-1);if(this.showMeridian)12<c&&(h=2,c-=12),h||(h=1),0===c&&(c=12),g=1===h?"AM":"PM";else if(12>c&&2===h)c+=12;else if(c>=this.maxHours)c=this.maxHours-1;else if(0>c||12===c&&1===h)c=0}this.hour=
c;this.snapToStep?(this.minute=this.changeToNearestStep(d,this.minuteStep),this.second=this.changeToNearestStep(a,this.secondStep)):(this.minute=d,this.second=a);this.meridian=g;this.update()}else this.clear()},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM"},update:function(){this.updateElement();this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},
updateFromElementVal:function(){this.setTime(this.$element.val())}};h.fn.timepicker=function(a){var c=Array.apply(null,arguments);c.shift();return this.each(function(){var d=h(this),k=d.data("timepicker"),A="object"===typeof a&&a;k||d.data("timepicker",k=new g(this,h.extend({},h.fn.timepicker.defaults,A,h(this).data())));"string"===typeof a&&k[a].apply(k,c)})};h.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",
y:"auto"},secondStep:15,snapToStep:!1,showSeconds:!1,showInputs:!0,showMeridian:!0,maxHours:24,explicitMode:!1};h.fn.timepicker.Constructor=g;h(c).on("focus.timepicker.data-api click.timepicker.data-api",'[data-provide\x3d"timepicker"]',function(a){var c=h(this);c.data("timepicker")||(a.preventDefault(),c.timepicker())})})(jQuery,window,document)});
Module.define("validate.apogee",["jquery","jquery.validate"],function(h){function d(c){c=void 0===c?{}:c;this.validator=null;var d=c;c=void 0===d.formJqueryEl?null:d.formJqueryEl;var a=void 0===d.validateOption?{}:d.validateOption;d=void 0===d.errorJSON?{}:d.errorJSON;d=(void 0===d.messages?[]:d.messages).reduce(function(a,c){c.propertyPath&&c.message&&(a[c.propertyPath]=c.message);return a},{});null==c?console.error("ValidateWithApogee is missing FORM element."):(this.validator=c.validate(a),this.validator.showErrors(d))}
d.prototype.getValidator=function(){return this.validator};d.NAME="ValidateWithApogee";d.SKIP_VALIDATE_CSS="skip-validate";return d});
Module.define("waitforimages",["jquery"],function(){var h=jQuery,d=function(c){return c.srcset&&c.sizes}(new Image);h.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"],hasImageAttributes:["srcset"]};h.expr.pseudos["has-src"]=function(c){return h(c).is('img[src][src!\x3d""]')};h.expr.pseudos.uncached=function(c){return h(c).is(":has-src")?!c.complete:!1};h.fn.waitForImages=function(){var c=0,g=0,a=h.Deferred(),k=this,p=[],l=h.waitForImages.hasImageProperties||
[],A=h.waitForImages.hasImageAttributes||[],r=/url\(\s*(['"]?)(.*?)\1\s*\)/g;if(h.isPlainObject(arguments[0])){var z=arguments[0].waitForAll;var t=arguments[0].each;var E=arguments[0].finished}else 1===arguments.length&&"boolean"===h.type(arguments[0])?z=arguments[0]:(E=arguments[0],t=arguments[1],z=arguments[2]);E=E||h.noop;t=t||h.noop;z=!!z;if(!h.isFunction(E)||!h.isFunction(t))throw new TypeError("An invalid callback was supplied.");this.each(function(){var a=h(this);z?a.find("*").addBack().each(function(){var a=
h(this);a.is("img:has-src")&&!a.is("[srcset]")&&p.push({src:a.attr("src"),element:a[0]});h.each(l,function(c,d){c=a.css(d);if(!c)return!0;for(;d=r.exec(c);)p.push({src:d[2],element:a[0]})});h.each(A,function(c,d){if(!a.attr(d))return!0;p.push({src:a.attr("src"),srcset:a.attr("srcset"),element:a[0]})})}):a.find("img:has-src").each(function(){p.push({src:this.src,element:this})})});c=p.length;g=0;0===c&&(E.call(k),a.resolveWith(k));h.each(p,function(l,p){l=new Image;h(l).one("load.waitForImages error.waitForImages",
function O(d){d=[g,c,"load"==d.type];g++;t.apply(p.element,d);a.notifyWith(p.element,d);h(this).off("load.waitForImages error.waitForImages",O);if(g==c)return E.call(k[0]),a.resolveWith(k[0]),!1});d&&p.srcset&&(l.srcset=p.srcset,l.sizes=p.sizes);l.src=p.src});return a.promise()}});